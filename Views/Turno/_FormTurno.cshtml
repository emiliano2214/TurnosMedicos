@using Microsoft.AspNetCore.Mvc.Rendering
@model TurnosMedicos.Models.ViewModels.TurnoForm

<div class="mb-3">
    <label asp-for="IdPaciente" class="form-label"></label>

    @* Si el usuario es Paciente, mostrar solo el nombre y enviar hidden *@
    @if (User.IsInRole("Paciente"))
    {
        <!-- Envia el ID al backend -->
        <input type="hidden" asp-for="IdPaciente" />

        <!-- Muestra el nombre verdadero del paciente -->
        <input class="form-control"
               value="@Model.NombrePaciente"
               disabled />
    }
    else
    {
        <select asp-for="IdPaciente"
                asp-items="(IEnumerable<SelectListItem>)ViewBag.Pacientes"
                class="form-control">
        </select>
    }

    <span asp-validation-for="IdPaciente" class="text-danger"></span>
</div>

<div class="mb-3">
    <label asp-for="IdMedico" class="form-label"></label>
    @if (User.IsInRole("Medico"))
    {
        <input type="hidden" asp-for="IdMedico" />
        <input class="form-control" value="@Model.NombreMedico" disabled />
    }
    else
    {
        <select asp-for="IdMedico"
                asp-items="(IEnumerable<SelectListItem>)ViewBag.Medicos"
                class="form-control">
        </select>
    }
    <span asp-validation-for="IdMedico" class="text-danger"></span>
</div>

<div class="mb-3">
    <label asp-for="FechaHora" class="form-label"></label>
    <input asp-for="FechaHora" type="datetime-local" class="form-control" />
    <span asp-validation-for="FechaHora" class="text-danger"></span>
</div>

<div class="mb-3">
    <label asp-for="Estado" class="form-label"></label>
    <select asp-for="Estado" class="form-control">
        <option value="Pendiente">Pendiente</option>
        <option value="Confirmado">Confirmado</option>
        <option value="Cancelado">Cancelado</option>
    </select>
    <span asp-validation-for="Estado" class="text-danger"></span>
</div>

@* Campos clínicos solo para staff *@
@if (User.IsInRole("Admin") || User.IsInRole("Administrativo") || User.IsInRole("Medico"))
{
    <div class="mb-3">
        <label asp-for="Diagnostico" class="form-label"></label>
        <textarea asp-for="Diagnostico" class="form-control" rows="3"></textarea>
        <span asp-validation-for="Diagnostico" class="text-danger"></span>
    </div>

    <div class="mb-3">
        <label asp-for="Tratamiento" class="form-label"></label>
        <textarea asp-for="Tratamiento" class="form-control" rows="3"></textarea>
        <span asp-validation-for="Tratamiento" class="text-danger"></span>
    </div>
}
